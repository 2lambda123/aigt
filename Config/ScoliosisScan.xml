<PlusConfiguration version="2.5">

	<DataCollection StartupDelaySec="1.0">
	
		<DeviceSet Name="Spine scan OptiTrack Duo" Description="Demo which uses the OptiTrack Duo and Telemed ultrasounds to demo the functionality of ScoliUs. This config is for calibration."/>
		
		<Device
		Id="TrackerDevice"
		Type="OptiTrack"
		ToolReferenceFrame="Tracker"
		ProjectFile="ScoliUsOptiTrack.ttp"
		AttachToRunningMotive="FALSE"
		MotiveDataDescriptionsUpdateTimeSec="1.0">
			<DataSources>
				<DataSource Type="Tool" Id="Reference"/>
				<DataSource Type="Tool" Id="Probe"/>
			</DataSources>
			<OutputChannels>
				<OutputChannel Id="TrackerStream">
					<DataSource Type="Tool" Id="Reference"/>
					<DataSource Type="Tool" Id="Probe"/>
				</OutputChannel>
			</OutputChannels>
		</Device>
		
		<Device Id="VideoDevice" Type="TelemedVideo" DepthMm="90">
			<DataSources>
				<DataSource Type="Video" Id="Video" PortUsImageOrientation="UF"/>
			</DataSources>
			<OutputChannels>
				<OutputChannel Id="VideoStream" VideoDataSourceId="Video"/>
			</OutputChannels>
		</Device>
		
		<Device Id="TrackedVideoDevice" Type="VirtualMixer">
			<InputChannels>
				<InputChannel Id="TrackerStream"/>
				<InputChannel Id="VideoStream"/>
			</InputChannels>
			<OutputChannels>
				<OutputChannel Id="TrackedVideoStream"/>
			</OutputChannels>
		</Device>
		
		<Device Id="CaptureDevice" Type="VirtualCapture" BaseFilename="RecordingTest.mhd" EnableCapturing="FALSE" EnableCompression="FALSE" FrameBufferSize="50">
			<InputChannels>
				<InputChannel Id="TrackedVideoStream"/>
			</InputChannels>
		</Device>
		
	</DataCollection>
	
	<CoordinateDefinitions>
		<Transform
		From="Image"
		To="Probe"
		Matrix=" 0.12913 -0.109897 0.085048 -38.1853
				0.0705074 -0.04823 -0.169374 -50.2865
				0.119746 0.146906 0.00801597 82.2645
				0 0 0 1 "/>
		
		<Transform From="Image" To="TransdPixel" Matrix=" 1 0 0 -260 0 1 0 -50 0 0 1 0 0 0 0 1"/>
		
		<Transform From="TransdPixel" To="Transd" Matrix=" 0.193681078 0 0 0 0 0.193681078 0 0 0 0 0.193681078 0 0 0 0 1"/>
	</CoordinateDefinitions>
	
	<PlusOpenIGTLinkServer
	  MaxNumberOfIgtlMessagesToSend="1"
	  MaxTimeSpentWithProcessingMs="50"
	  ListeningPort="18944"
	  SendValidTransformsOnly="true"
	  OutputChannelId="TrackedVideoStream">
		<DefaultClientInfo>
			<MessageTypes>
				<Message Type="IMAGE"/>
				<Message Type="TRANSFORM"/>
			</MessageTypes>
			<TransformNames>
				<Transform Name="ProbeToTracker"/>
				<Transform Name="ReferenceToTracker"/>
				<Transform Name="ImageToReference"/>
			</TransformNames>
			<ImageNames>
				<Image Name="Image" EmbeddedTransformToFrame="Image"/>
			</ImageNames>
		</DefaultClientInfo>
	</PlusOpenIGTLinkServer>
	
</PlusConfiguration>